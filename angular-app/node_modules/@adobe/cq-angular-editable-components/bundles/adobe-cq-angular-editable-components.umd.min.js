!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@adobe/cq-spa-component-mapping"),require("@adobe/cq-spa-page-model-manager"),require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("@adobe/cq-angular-editable-components",["exports","@adobe/cq-spa-component-mapping","@adobe/cq-spa-page-model-manager","@angular/core","@angular/common"],e):e((t.adobe=t.adobe||{},t.adobe["cq-angular-editable-components"]={}),null,null,t.ng.core,t.ng.common)}(this,function(t,e,n,o,a){"use strict";var r=function(){function t(t){this.spaMapping=t,this.editConfigMap={}}return t.prototype.map=function(t,e,n){void 0===n&&(n=null);var o=e;n&&(this.editConfigMap[t]=n),this.spaMapping.map(t,o)},t.prototype.get=function(t){return this.spaMapping.get(t)},t.prototype.getEditConfig=function(t){return this.editConfigMap[t]},t}(),i=new r(e.ComponentMapping);var s={NEW_SECTION_CLASS_NAMES:"new section",TYPE_PROP:n.Constants.TYPE_PROP,ITEMS_PROP:n.Constants.ITEMS_PROP,ITEMS_ORDER_PROP:n.Constants.ITEMS_ORDER_PROP,PATH_PROP:n.Constants.PATH_PROP,CHILDREN_PROP:n.Constants.CHILDREN_PROP,DATA_PATH_PROP:":dataPath",HIERARCHY_TYPE_PROP:n.Constants.HIERARCHY_TYPE_PROP};function p(){if(function(){try{return"undefined"!=typeof window}catch(t){return!1}}()){var t=document.head.querySelector('meta[property="cq:wcmmode"]');return t&&t.content}}var c={isInEditor:function(){var t=p();return t&&("edit"===t||"preview"===t)}},m="cq-placeholder",u=function(){function t(t,e,n,o){this.renderer=t,this.viewContainer=e,this.factoryResolver=n,this.ngZone=o}return Object.defineProperty(t.prototype,"cqItem",{get:function(){return this._cqItem},set:function(t){this._cqItem=t,this.updateComponentData()},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.renderComponent(i.get(this.type))},Object.defineProperty(t.prototype,"type",{get:function(){return this.cqItem&&this.cqItem[s.TYPE_PROP]},enumerable:!0,configurable:!0}),t.prototype.renderComponent=function(t){if(t){var e=this.factoryResolver.resolveComponentFactory(t);this.viewContainer.clear(),this._component=this.viewContainer.createComponent(e),this.updateComponentData()}},t.prototype.updateComponentData=function(){var o=this;if(this._component&&this._component.instance){Object.getOwnPropertyNames(this.cqItem).forEach(function(t){var e=t;if(e.startsWith(":")){var n=e.substr(1);e="cq"+n.substr(0,1).toUpperCase()+n.substr(1)}o._component.instance[e]=o.cqItem[t]}),this._component.instance.cqPath=this.cqPath,this._component.instance.itemName=this.itemName;var t=i.getEditConfig(this.type);t&&c.isInEditor&&this.setupPlaceholder(t)}},t.prototype.setupItemAttrs=function(){var e=this;this.itemAttrs&&Object.getOwnPropertyNames(this.itemAttrs).forEach(function(t){"class"===t?e.itemAttrs[t].split(" ").forEach(function(t){e.renderer.addClass(e._component.location.nativeElement,t)}):e.renderer.setAttribute(e._component.location.nativeElement,t,e.itemAttrs[t])})},t.prototype.usePlaceholder=function(t){return t.isEmpty&&"function"==typeof t.isEmpty&&t.isEmpty(this.cqItem)},t.prototype.setupPlaceholder=function(t){this.usePlaceholder(t)?(this.renderer.addClass(this._component.location.nativeElement,m),this.renderer.setAttribute(this._component.location.nativeElement,"data-emptytext",t.emptyLabel)):(this.renderer.removeClass(this._component.location.nativeElement,m),this.renderer.removeAttribute(this._component.location.nativeElement,"data-emptytext"))},t.prototype.ngAfterViewInit=function(){this.setupItemAttrs()},t.prototype.ngOnDestroy=function(){this._component&&this._component.destroy()},t.decorators=[{type:o.Directive,args:[{selector:"[aemComponent]"}]}],t.ctorParameters=function(){return[{type:o.Renderer2},{type:o.ViewContainerRef},{type:o.ComponentFactoryResolver},{type:o.NgZone}]},t.propDecorators={cqItem:[{type:o.Input}],cqPath:[{type:o.Input}],itemName:[{type:o.Input}],itemAttrs:[{type:o.Input}],aemComponent:[{type:o.Input}]},t}(),l=s.NEW_SECTION_CLASS_NAMES,h=function(){function t(){this.cqPath="",this.modelName=""}return Object.defineProperty(t.prototype,"isInEditMode",{get:function(){return c.isInEditor()},enumerable:!0,configurable:!0}),t.prototype.getDataPath=function(t){return this.cqPath?this.cqPath+"/"+t:t},t.prototype.getItem=function(t){return this.cqItems&&this.cqItems[t]},t.prototype.getHostClassNames=function(){return"aem-container"},Object.defineProperty(t.prototype,"hostClasses",{get:function(){return this.getHostClassNames()},enumerable:!0,configurable:!0}),t.prototype.getPlaceholderClassNames=function(){return l},Object.defineProperty(t.prototype,"placeholderPath",{get:function(){return this.cqPath&&this.cqPath+"/*"},enumerable:!0,configurable:!0}),t.decorators=[{type:o.Component,args:[{selector:"aem-container",host:{"[class]":"hostClasses","[attr.data-cq-data-path]":"cqPath"},template:'<ng-container *ngFor="let itemKey of cqItemsOrder">\n  <ng-container [aemComponent] [cqItem]=\'getItem(itemKey)\' [cqPath]=\'getDataPath(itemKey)\' [itemName]=\'itemKey\'></ng-container>\n  <div *ngIf="isInEditMode" [attr.data-cq-data-path]="placeholderPath" [class]="getPlaceholderClassNames()"></div>\n</ng-container>\n'}]}],t.propDecorators={cqItems:[{type:o.Input}],cqItemsOrder:[{type:o.Input}],cqPath:[{type:o.Input}],modelName:[{type:o.Input}],classNames:[{type:o.Input}]},t}(),d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};function f(t,e){function n(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return f(t,e),t.prototype.getColumnClassNames=function(t){return this.columnClassNames&&this.columnClassNames[t]},t.prototype.getPlaceholderClassNames=function(){return e.prototype.getPlaceholderClassNames.call(this)+" aem-Grid-newComponent"},t.prototype.getHostClassNames=function(){var t=e.prototype.getHostClassNames.call(this);return this.classNames&&(t+=" "+(this.classNames||"")),t+" "+this.gridClassNames},t.prototype.getAttrDataPath=function(t){var e=this.getItem(t);return e&&"wcm/foundation/components/responsivegrid"===e[s.TYPE_PROP]?null:this.getDataPath(t)},t.decorators=[{type:o.Component,args:[{selector:"aem-responsivegrid",host:{"[class]":"hostClasses","[attr.data-cq-data-path]":"cqPath"},template:'<ng-container *ngFor="let itemKey of cqItemsOrder">\n  <div [aemModelProvider] [cqItem]=\'getItem(itemKey)\' [cqPath]=\'getDataPath(itemKey)\' [itemName]=\'itemKey\' [class]="getColumnClassNames(itemKey)" [attr.data-cq-data-path]=\'getAttrDataPath(itemKey)\'>\n  </div>\n</ng-container>\n<div *ngIf="isInEditMode" [attr.data-cq-data-path]="placeholderPath" [class]="getPlaceholderClassNames()"></div>\n\n\n'}]}],t.propDecorators={gridClassNames:[{type:o.Input}],columnClassNames:[{type:o.Input}],classNames:[{type:o.Input}],columnCount:[{type:o.Input}]},t}(h),g=function(){function t(t){this.ngZone=t}return t.prototype.updateItem=function(){var e=this;n.ModelManager.getData({path:this.cqPath}).then(function(t){e.ngZone.run(function(){e.cqItem=t})})},t.prototype.ngOnInit=function(){n.ModelManager.addListener(this.cqPath,this.updateItem.bind(this))},t.prototype.ngDestroy=function(){n.ModelManager.removeListener(this.cqPath,this.updateItem.bind(this))},t.decorators=[{type:o.Component,args:[{selector:"[aemModelProvider]",template:"<ng-container [aemComponent] [cqItem]='cqItem' [cqPath]='cqPath' [itemName]='itemName'></ng-container>"}]}],t.ctorParameters=function(){return[{type:o.NgZone}]},t.propDecorators={cqPath:[{type:o.Input}],cqItem:[{type:o.Input}],itemName:[{type:o.Input}],aemModelProvider:[{type:o.Input}]},t}(),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.getDataPath=function(t){return this.cqPath?this.cqPath+"/jcr:content/"+t:t},e.decorators=[{type:o.Component,args:[{selector:"aem-page",host:{"[class]":"hostClasses","[attr.data-cq-data-path]":"cqPath"},template:'<ng-container *ngFor="let itemKey of cqItemsOrder">\n  <ng-container [aemComponent] [cqItem]=\'getItem(itemKey)\' [cqPath]=\'getDataPath(itemKey)\' [itemName]=\'itemKey\'></ng-container>\n  <div *ngIf="isInEditMode" [attr.data-cq-data-path]="placeholderPath" [class]="getPlaceholderClassNames()"></div>\n</ng-container>\n'}]}],e}(h),C=function(){function t(){}return t.decorators=[{type:o.NgModule,args:[{imports:[a.CommonModule],declarations:[h,y,u,g,P],exports:[h,y,u,g,P],entryComponents:[h,y,P]}]}],t}(),I=function(){function t(){}return t.prototype.resolve=function(t){return"/"+t.url.join("/").replace(/\.[^/.]+$/,"")},t.decorators=[{type:o.Injectable}],t.ctorParameters=function(){return[]},t}(),q=function(){function t(){}return t.prototype.shouldDetach=function(t){return!1},t.prototype.store=function(t,e){},t.prototype.shouldAttach=function(t){return!1},t.prototype.retrieve=function(t){return null},t.prototype.shouldReuseRoute=function(t,e){return!1},t}();t.AEMComponentDirective=u,t.AEMContainerComponent=h,t.AEMResponsiveGridComponent=y,t.ComponentMappingWithConfig=r,t.ComponentMapping=i,t.MapTo=function(n){return function(t,e){return void 0===e&&(e=null),i.map(n,t,e)}},t.Constants=s,t.Utils=c,t.SpaAngularEditableComponentsModule=C,t.AemPageDataResolver=I,t.AemPageRouteReuseStrategy=q,t.ɵa=g,t.ɵb=P,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=adobe-cq-angular-editable-components.umd.min.js.map